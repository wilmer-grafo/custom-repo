SHOW datestyle;
SHOW TIMEZONE;
COPY alzada.alz_actos_impugnados from 'C:\Users\wvillca\Result_35.csv' delimiter ',' csv header;
SELECT * FROM alzada.alz_actos_impugnados;


TRUNCATE TABLE alzada.alz_montos_alzada RESTART IDENTITY;
TRUNCATE TABLE alzada.alz_actos_impugnados RESTART IDENTITY CASCADE;
select * from alzada.alz_recursos_alzada where numero_recurso_alzada = 'ARIT-BEN-0002/2010';
select * from alzada.alz_actos_impugnados where id_recurso_alzada = 14;

select numero_recurso_alzada, id from alzada.alz_recursos_alzada
                           where numero_recurso_alzada in
select count(*) from(
    select concat(numero_recurso_alzada, ' ')
    from alzada.alz_recursos_alzada
    where numero_recurso_alzada ilike 'ARIT-BEN-%'
    group by numero_recurso_alzada) as f

select id_recurso_alzada from alzada.alz_actos_impugnados group by id_recurso_alzada

select concat(id_recurso_alzada, ' ')
    from alzada.alz_actos_impugnados
    group by id_recurso_alzada

-- DETERMINA LA SERIE FALTANTE *PG*
SELECT s.id AS missing_ids
    FROM generate_series(1, 500) s(id)
    WHERE NOT EXISTS (SELECT 1 FROM parametricas.par_tipos_actuaciones WHERE id = s.id);
-- PARA INSERTAR EL ID 100  *PG*
SELECT setval(pg_get_serial_sequence('parametricas.par_tipos_actuaciones', 'id'),
              (SELECT 99 FROM parametricas.par_tipos_actuaciones limit 1));
-- PARA VOLVER
SELECT setval(pg_get_serial_sequence('parametricas.par_tipos_actuaciones', 'id'),
              (SELECT max(id) FROM parametricas.par_tipos_actuaciones));

TRUNCATE TABLE alzada.alz_representantes_at RESTART IDENTITY ;
DELETE FROM alzada.alz_representantes_at WHERE id > 0;

DEBIAN
======

drop table parametricas.par_administraciones_tributarias cascade;

drop table parametricas.par_subadministraciones_tributarias cascade;

drop table seguridad.seg_personas cascade;

drop table seguridad.seg_usuarios cascade;

truncate table alzada.alz_recursos_alzada;

drop table parametricas.par_tipos_actos cascade;

drop table parametricas.par_tipos_impuestos cascade;

truncate table alzada.alz_actos_impugnados restart identity cascade;

truncate table alzada.alz_montos_alzada restart identity;

drop table parametricas.par_tipos_actuaciones cascade;

DELETE FROM alzada.alz_actuaciones;

truncate table alzada.alz_notificaciones restart identity;

truncate table alzada.alz_representantes_at restart identity cascade;

truncate table alzada.alz_recursos_alzada_representantes_at restart identity cascade;

truncate table alzada.alz_representantes_sp restart identity cascade;

truncate table alzada.alz_recursos_alzada_representantes_sp restart identity cascade;

truncate table alzada.alz_interposiciones_jerarquico restart identity cascade;

truncate table comunes.feriados restart identity cascade;

truncate table parametricas.par_tipos_cambios_ufv restart identity cascade;


==================
UPDATE - RECURSOS
==================

----------------------
-- alz_recursos_alzada
----------------------
update alzada.alz_recursos_alzada
set fecha_registra = fecha_registra + interval '4 hours';

update alzada.alz_recursos_alzada
set fecha_presentacion = fecha_presentacion + interval '4 hours';

----------------------
-- alz_actos_impugnados
----------------------
update alzada.alz_actos_impugnados
set fecha_emision = fecha_emision + interval '4 hours';

update alzada.alz_actos_impugnados
set fecha_notificacion = fecha_notificacion + interval '4 hours';

----------------------
-- alz_actuaciones
----------------------
update alzada.alz_actuaciones
set fecha_emision = fecha_emision + interval '4 hours';

update alzada.alz_actuaciones
set fecha_subsanacion = fecha_subsanacion + interval '4 hours';

----------------------
-- alz_notificaciones
----------------------
update alzada.alz_notificaciones
set fecha_hora_notificacion = fecha_hora_notificacion + interval '4 hours';

update alzada.alz_notificaciones
set fecha_actuacion_registro = fecha_actuacion_registro + interval '4 hours';

----------------------
-- alz_representantes_at
----------------------
update alzada.alz_representantes_at
set fecha_desde = fecha_desde + interval '4 hours';

update alzada.alz_representantes_at
set fecha_hasta = fecha_hasta + interval '4 hours';

---------------------------------
-- alz_interposiciones_jerarquico
---------------------------------
update alzada.alz_interposiciones_jerarquico
set fecha_interpone = fecha_interpone + interval '4 hours';

update alzada.alz_interposiciones_jerarquico
set fecha_remision = fecha_remision + interval '4 hours';

update alzada.alz_interposiciones_jerarquico
set fecha_recepcion_agit = fecha_recepcion_agit + interval '4 hours';

-----------
-- feriados
-----------
update comunes.feriados
set fecha = fecha + interval '4 hours';

----------------------
-- par_tipos_cambios_ufv
----------------------
update parametricas.par_tipos_cambios_ufv
set fecha = fecha + interval '4 hours';



truncate table alzada.alz_registros_documentales_sustantivos restart identity cascade;

truncate table alzada.alz_registros_documentales_sustantivos_anexos restart identity;

truncate table comunes.memoriales restart identity cascade;

==============
UPDATE - ARTIS
==============

--------------------------------------------
-- alz_registros_documentales_sustantivos
--------------------------------------------
update alzada.alz_registros_documentales_sustantivos
set fecha_recepcion = fecha_recepcion + interval '4 hours';

update alzada.alz_registros_documentales_sustantivos
set fecha_inicio = fecha_inicio + interval '4 hours';

update alzada.alz_registros_documentales_sustantivos
set fecha_deriva = fecha_deriva + interval '4 hours';




update comunes.memoriales
set fecha_recepcion = fecha_recepcion + interval '4 hours';

update comunes.memoriales
set fecha_respuesta = fecha_respuesta + interval '4 hours';

truncate table alzada.alz_aclaraciones restart identity cascade;

update alzada.alz_aclaraciones
set fecha_liberacion = fecha_liberacion + interval '4 hours';

update alzada.alz_aclaraciones
set fecha_entrega = fecha_entrega + interval '4 hours';

truncate table alzada.alz_registros_documentales_sustantivos_anexos restart identity cascade;

update alzada.alz_solicitudes_procesos
set fecha_solicita = fecha_solicita + interval '4 hours';

truncate table alzada.alz_trazabilidad_solicitudes_procesos restart identity cascade;

update alzada.alz_trazabilidad_solicitudes_procesos
set fecha_accion = fecha_accion + interval '4 hours';

truncate table alzada.alz_notas restart identity cascade;

update alzada.alz_notas
set fecha_nota = fecha_nota + interval '4 hours';




