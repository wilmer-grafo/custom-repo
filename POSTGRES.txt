SHOW datestyle;
SHOW TIMEZONE;
COPY alzada.alz_actos_impugnados from 'C:\Users\wvillca\Result_35.csv' delimiter ',' csv header;
SELECT * FROM alzada.alz_actos_impugnados;


TRUNCATE TABLE alzada.alz_montos_alzada RESTART IDENTITY;
TRUNCATE TABLE alzada.alz_actos_impugnados RESTART IDENTITY CASCADE;
select * from alzada.alz_recursos_alzada where numero_recurso_alzada = 'ARIT-BEN-0002/2010';
select * from alzada.alz_actos_impugnados where id_recurso_alzada = 14;

select numero_recurso_alzada, id from alzada.alz_recursos_alzada
                           where numero_recurso_alzada in
select count(*) from(
    select concat(numero_recurso_alzada, ' ')
    from alzada.alz_recursos_alzada
    where numero_recurso_alzada ilike 'ARIT-BEN-%'
    group by numero_recurso_alzada) as f

select id_recurso_alzada from alzada.alz_actos_impugnados group by id_recurso_alzada

select concat(id_recurso_alzada, ' ')
    from alzada.alz_actos_impugnados
    group by id_recurso_alzada

-- DETERMINA LA SERIE FALTANTE *PG*
SELECT s.id AS missing_ids
    FROM generate_series(1, 500) s(id)
    WHERE NOT EXISTS (SELECT 1 FROM parametricas.par_tipos_actuaciones WHERE id = s.id);
-- PARA INSERTAR EL ID 100  *PG*
SELECT setval(pg_get_serial_sequence('parametricas.par_tipos_actuaciones', 'id'),
              (SELECT 99 FROM parametricas.par_tipos_actuaciones limit 1));
-- PARA VOLVER
SELECT setval(pg_get_serial_sequence('parametricas.par_tipos_actuaciones', 'id'),
              (SELECT max(id) FROM parametricas.par_tipos_actuaciones));

TRUNCATE TABLE alzada.alz_representantes_at RESTART IDENTITY ;
DELETE FROM alzada.alz_representantes_at WHERE id > 0;

DEBIAN
======

drop table parametricas.par_administraciones_tributarias cascade;

drop table parametricas.par_subadministraciones_tributarias cascade;

drop table seguridad.seg_personas cascade;

drop table seguridad.seg_usuarios cascade;

truncate table alzada.alz_recursos_alzada;

drop table parametricas.par_tipos_actos cascade;

drop table parametricas.par_tipos_impuestos cascade;

truncate table alzada.alz_actos_impugnados restart identity cascade;

truncate table alzada.alz_montos_alzada restart identity;

drop table parametricas.par_tipos_actuaciones cascade;

DELETE FROM alzada.alz_actuaciones;

truncate table alzada.alz_notificaciones restart identity;

truncate table alzada.alz_representantes_at restart identity cascade;

truncate table alzada.alz_recursos_alzada_representantes_at restart identity cascade;

truncate table alzada.alz_representantes_sp restart identity cascade;

truncate table alzada.alz_recursos_alzada_representantes_sp restart identity cascade;

truncate table alzada.alz_interposiciones_jerarquico restart identity cascade;

truncate table comunes.feriados restart identity cascade;

truncate table parametricas.par_tipos_cambios_ufv restart identity cascade;



truncate table alzada.alz_registros_documentales_sustantivos restart identity cascade;

truncate table alzada.alz_registros_documentales_sustantivos_anexos restart identity;

truncate table comunes.memoriales restart identity cascade;

truncate table alzada.alz_aclaraciones restart identity cascade;

truncate table alzada.alz_trazabilidad_solicitudes_procesos restart identity;

truncate table alzada.alz_notas restart identity cascade;


TOTALES

SELECT COUNT(ra.C_Nro_Expediente)
FROM TSS_RECURSOS_ALZADA AS ra
WHERE LTRIM(RTRIM(ra.C_Nro_Expediente)) LIKE '%2021%';


SELECT COUNT(ra.C_Nro_Expediente)
FROM TSS_ACTOS_IMPUGNADOS AS ra
WHERE LTRIM(RTRIM(ra.C_Nro_Expediente)) LIKE '%2021%';

SELECT COUNT(ra.C_Nro_Expediente)
FROM TSS_MONTOS AS ra
WHERE LTRIM(RTRIM(ra.C_Nro_Expediente)) LIKE '%2021%';

SELECT COUNT(ra.C_Nro_Expediente)
FROM TSS_AUTOS AS ra
WHERE LTRIM(RTRIM(ra.C_Nro_Expediente)) LIKE '%2021%';

SELECT COUNT(*)
FROM TSS_AUTOS
WHERE D_Fecha_Emision  BETWEEN '2021-01-01' AND '2021-12-31'
AND C_Nro_Expediente LIKE '%2021%';


select count(id)
from alzada.alz_recursos_alzada;

select count(ai.id)
from alzada.alz_actos_impugnados ai;

select count(ama.id)
from alzada.alz_montos_alzada as ama;

select count(rds.id)
from alzada.alz_actuaciones as rds;
