-- truncar la tabla y reiniciar la sequencia
TRUNCATE TABLE seguridad.seg_personas RESTART IDENTITY CASCADE;


36,GARI EDUARDO,PERALES,SÁNCHEZ,gperales
119,GARI,PERALES,SANCHEZ,gperales

196,BORIS,CHURA,"",bchura
190,Boris,Chura,Zegarra,bchura

337,ADALID,CHINO,"",achinos
282,ADALID,CHINO,CALLE,achino
350,ADALID ANDRES,CHINO,CALLE,achino1
393,ADALID ANDRES,CHINO,CALLE,achinot

210,ALVARO,CARRASCO ,QUINTEROS,alcarrascoq
446,ALVARO,CARRASCO,QUINTEROS,acarrascor

448,Alvaro Danilo,Illanes,Landa,aillaneslr
315,Alvaro Danilo,Illanes,Landa,aillanesl

33,Carla Patricia,Cazuriaga,Bravo,ccazuriaga
293,CARLA PATRICIA,CAZURIAGA,BRAVO,ccazuriagar

95,CARMEN,SALAS, ,csalas
175,CARMEN,SALAS,AGUILAR,csalasa

391,CARMEN,VALLE,"",cvalle1
395,CARMEN,VALLE,ALARCON,cvalleae
423,CARMEN,VALLE,ALARCON,cvalleofi
343,CARMEN,VALLE,ALARCON,cvalle

513,CIMAR,PRADO,CAREAGA,cpradoa
514,CIMAR,PRADO,CAREAGA,cprados
461,CIMAR ALVARO,PRADO,CAREAGA,cprado

449,CINTHYA GABRIELA,VALDEZ,SEGOVIA,cvaldezs
444,CINTHYA GABRIELA,VALDEZ,SEGOVIA,cvaldez

299,CLAUDIA IRENE,ASTURIZAGA,RÍOS,casturizagat
417,Claudia Irene,Asturizaga,Ríos,casturizagag
53,Claudia Irene,Asturizaga,Ríos,casturizaga
283,CLAUDIA IRENE,ASTURIZAGA,RÍOS,casturizagas

358,Cristian Rodrigo ,Mora,Miranda,cmora
419,Cristian Rodrigo ,Mora,Miranda,cmorar

271,DANIEL EDUARDO,MOLINA,BASCOPE,dmolinar
97,Daniel Eduardo,Molina,Bascope,dmolina

467,DANIELA,RIVERO,ARROYO,drivero
473,DANIELA,RIVERO,ARROYO,driveroa

434,Diana Miriam,Martinez,Miranda,dmartinezr
310,Diana Miriam,Martinez,Miranda,dmartinez
512,Diana Miriam,Martinez,Miranda,dmartinezri

281,DIEGO,ONTIVEROS,"",dontiveros1
266,DIEGO,ONTIVEROS,TAMES,dontiveros

432,DIEGO,ZAPATA,CRESPO,dzapataa
401,DIEGO,ZAPATA,CRESPO,dzapata

418,Eliseo Santos,Ochoa,Urquizo,eochoat
285,Eliseo Santos,Ochoa,Urquizo,eochoa

318,ERICK RAUL,SUÁREZ,ROSSI,esuarez
411,ERICK RAUL,SUÁREZ,ROSSI,esuarezo
412,ERICK RAUL,SUÁREZ,ROSSI,esuarezs

134,ERNESTO,MARIÑO,BORQUEZ,emariñoC
127,ERNESTO RUFO,MARIÑO ,BORQUEZ,emarino

330,Fily Amalia,Chucatiny,Torrico,achucatinyr
55,Fily Amalia,Chucatiny,Torrico,achucatiny

280,FRANZ ,SUBIETA,RENTERIA,fsubieta
309,FRANZ DANIEL ,SUBIETA,RENTERÍA,fsubieta1

170,FREDDY ANTONIO,ACEBEY,GOMEZ,facebey
356,FREDDY ANTONIO,ACEBEY,GOMEZ,facebeyn
352,FREDDY ANTONIO,ACEBEY,GOMEZ,facebeys

--no migrar
34,GABRIEL,VALLEJOS,MAMANI,gvallejos
1,GABRIEL ANGEL,VALLEJOS,MAMANI,arit

--gcoimbrap
369,GIOVANNA,COIMBRA,MEDINA,gcoimbra
382,GIOVANNA,COIMBRA,MEDINA,gcoimbrab
410,GIOVANNA,COIMBRA,MEDINA,gcoimbrao
420,GIOVANNA,COIMBRA,MEDINA,gcoimbrar

48,GUALBERTO,TRUJILLO,LAGUNA,gtrujillo
300,GUALBERTO,TRUJILLO,LAGUNA,gtrujillot

381,GUSTAVO,YANIQUE,MERCADO,gyanique
386,GUSTAVO OLIVER,YANIQUE,MERCADO,gyanique

200,HELEN PATRICIA,PANTOJA,SERRANO,hpantoja
383,HELEN PATRICIA,PANTOJA,SERRANO,hpantojab
320,HELEN PATRICIA,PANTOJA,SERRANO,hpantojaa
357,HELEN PATRICIA,PANTOJA,SERRANO,hpantojan

--no migrar
301,JOSE EDUARDO,ALVAREZ,"",jalvarez1
216,JOSE EDUARDO,ALVAREZ,GARCIA,jalvarez2

128,JOSÉ LUIS,LOZA, DURÁN,jloza
368,JOSÉ LUIS,LOZA, DURÁN,jlozas
366,JOSÉ LUIS,LOZA, DURÁN,jlozao
392,JOSÉ LUIS,LOZA,DURÁN,jloza1
403,JOSÉ LUIS,LOZA,DURÁN,jlozar

297,JOSE MIGUEL,SANTALLA,SANDOVAL,jsantallat
259,Jose Miguel,Santalla,Sandoval,jsantalla

390,JUAN,TICONA,,jticonatja
291,JUAN,TICONA,CONDORI,jticona

499,JUAN CARLOS,ZABALA,IRIONDO,jzabala
500,JUAN CARLOS,ZABALA,IRIONDO,jzabalai

333,KARINA ZULEMA,VILLEGAS,NOGUERA,kvillegas
107,KARINA ZULEMA,VILLEGAS,NOGUERA,kvillegas.tja

45,KARYN,ORELLANA,,korellana
279,KARYN ,ORELLANA,"",korellanar

405,LAURA OCTAVINA,PACHECO,VIA,lpacheco
482,LAURA OCTAVINA,PACHECO,VIA,lpachecov

278,Lesly Gretzel,Leon,Martinez,lleon
292,Lesly Gretzel,Leon,Martinez,lleonr

404,LIZETH,ESPADA,PINTO,lespadacam
188,LIZETH,ESPADA,PINTO,lespada

398,Maria del Carmen,Carpio,Salazar,mcarpioa
346,Maria del Carmen,Carpio,Salazar,mcarpio

308,Maria Esperanza,Oporto,Torrez,moportor
46,Maria Esperanza,Oporto,Torrez,moporto

174,MARIA ESTHER,CHAVEZ,ANTELO,mchavez
28,MARÍA ESTHER,CHAVEZ,ANTELO,mchavez

312,MARIA MANUELA,ANIBARRO,VARGAS,manibarro
325,MARIA MANUELA,ANIBARRO,VARGAS,manibarroj
323,MARIA MANUELA,ANIBARRO,VARGAS,manibarroa
397,MARIA MANUELA,ANIBARRO,VARGAS,manibarros

469,MARY,MOYA,GUZMAN,mmoyaa
421,MARY,MOYA,GUZMAN,mmoyas
394,MARY,MOYA,GUZMAN,mmoyaofi
345,MARY ELISA,MOYA,GUZMAN ,mmoya

317,NILS,VASQUEZ,"",nvasquez
491,NILS,VASQUEZ,IMPRESOR,nvasquezi

463,OMAR,SERRANO,AVERANGA,oserrano
492,OMAR,SERRANO,IMPRESOR,oserranoi

334,PABLO,BARRIENTOS,MARTINEZ,pbarrientos
351,PABLO ORLANDO,BARRIENTOS,MARTINEZ,pbarrientos1

108,PAOLA,RODRIGO,VARGAS,prodrigo
161,PAOLA,RODRIGO,VARGAS,parodrigo

235,PEDRO,CONDE,LAIME,pconde
114,PEDRO,CONDE,LAIME,pcondes
402,PEDRO,CONDE,LAIME,pcondet
251,PEDRO,CONDEOR,"",pcondeor

50,RADA,OSINAGA,GUTIERREZ,rosinaga
136,RADA,OSINAGA,GUTIERREZ,rosinaga

295,RENÉ ERNESTO,PARAVICINI ,GUZMÁN,rparavicinit
125,René Ernesto,Paravicini,Guzmán,rparavicini

57,RENÉ LUIS,HUANCA,VASQUEZ,rhuanca
497,RENÉ LUIS,HUANCA,VASQUEZ,rhuancaj

60,Sonia,Mercado,Monroy,smercado
296,SONIA,MERCADO,MONROY,smercadot

63,Telma Susana,Togo,Coca,ttogo
298,Telma Susana,Togo,COca,ttogot
364,TELMA SUSANA,TOGO,COCA,ttogos

163,VANESSA,ESCOBAR,MONCADA,vaescobar
305,VANESSA,ESCOBAR,MONCADA,vaescobars

322,VERONICA,LAURA,CUSICANQUI,vlaura
355,VERONICA,LAURA,CUSICANQUI,vlaurad
515,VERONICA,LAURA,CUSICANQUI,vlaurac

-- no migrar
146,VICEMINISTERIO,DE POLITICA,TRIBUTARIA,vptributaria
160,VICEMINISTERIO,DE POLITICA,TRIBUTARIA,hugovpt

150,VICTOR,ESCOBAR,MAMANI,vescobar
517,VICTOR,ESCOBAR,MAMANI,vescobarm
430,VICTOR,ESCOBAR,MAMANI,vescobarr
304,VICTOR,ESCOBAR,MAMANI,vescobars

504,Virna Jenny,Campero,Gomez,vicamperor
124,Virna Jenny,Campero,Gomez,vicampero

62,ZENÓN,ARCE,PALLE,zarce
274,ZENÓN,ARCE,PALLE,zarcer

-- funcionarios con logins
--=================================================================================================================--
SELECT *
FROM (SELECT tf.C_Nombre,
             tf.C_Apellido_Paterno,
             tf.C_Apellido_Materno,
             STUFF(
                     (SELECT C_Login + ', '
                      FROM TSS_FUNCIONARIOS
                      WHERE (C_Nombre = tf.C_Nombre AND C_Apellido_Paterno = tf.C_Apellido_Paterno AND
                             C_Apellido_Materno = tf.C_Apellido_Materno)
                      FOR XML PATH (''))
                 , 1, 0, '') AS Logins
      FROM TSS_FUNCIONARIOS AS tf
      GROUP BY tf.C_Nombre, tf.C_Apellido_Paterno, tf.C_Apellido_Materno) AS temp
ORDER BY temp.C_Nombre, temp.C_Apellido_Paterno, temp.C_Apellido_Materno;
--=================================================================================================================--

-- ver la sequencia
--=================================================================================================================--
SELECT (SELECT ISNULL(MAX(N_Codigo_Funcionario) + 1, 1)
        FROM [TSS_FUNCIONARIOS]
        WHERE N_Codigo_Funcionario < md.N_Codigo_Funcionario) AS [de],
       md.N_Codigo_Funcionario - 1                        AS [hasta]
FROM [TSS_FUNCIONARIOS] md
WHERE md.N_Codigo_Funcionario != 1
  AND NOT EXISTS(
        SELECT 1 FROM [TSS_FUNCIONARIOS] md2 WHERE md2.N_Codigo_Funcionario = md.N_Codigo_Funcionario - 1);
--=================================================================================================================--