-- obtener los expedientes <= 20, SQL SERVER 

SELECT dd.id_exp, 1 AS id
FROM (SELECT LTRIM(RTRIM(id_exp)) as id_exp
      FROM control_tiempo_aclaracion
      WHERE (LTRIM(RTRIM(id_exp)) LIKE 'ARIT-LPZ-%/2021%' OR LTRIM(RTRIM(id_exp)) LIKE 'ARIT-LPZ-%/2022%')
        AND LEN(id_exp) <= 20
      GROUP BY LTRIM(RTRIM(id_exp))) AS dd
ORDER BY dd.id_exp;

-- obtener los id's de los expedientes, PG

select numero_recurso_alzada, id
FROM alzada.alz_recursos_alzada
where numero_recurso_alzada in (

    )
order by numero_recurso_alzada;


ARMAR
LTRIM(RTRIM(ct.id_exp))


-- obtener los expedientes > 20, SQL SERVER 

SELECT (CASE
            WHEN LEN(LTRIM(RTRIM(dd.id_exp))) > 20 THEN SUBSTRING(LTRIM(RTRIM(id_exp)), 0,
                                                                  CHARINDEX('//', LTRIM(RTRIM(id_exp))))
            ELSE LTRIM(RTRIM(dd.id_exp))
    END) AS exp,
       1 AS id
FROM (SELECT LTRIM(RTRIM(id_exp)) AS id_exp
      FROM control_tiempo_aclaracion
      WHERE SUBSTRING(LTRIM(RTRIM(id_exp)), 0, CHARINDEX('//', LTRIM(RTRIM(id_exp)))) LIKE 'ARIT-LPZ-%/2021%'
        AND LEN(LTRIM(RTRIM(id_exp))) > 20
      GROUP BY LTRIM(RTRIM(id_exp))) AS dd
ORDER BY dd.id_exp;


-- obtener los id's de los expedientes, PG

select numero_recurso_alzada, id
FROM alzada.alz_recursos_alzada
where numero_recurso_alzada in (

    )
order by numero_recurso_alzada;

-- armar con estos valores
SELECT  dd.id_exp, 1 AS id
FROM (SELECT LTRIM(RTRIM(id_exp)) AS id_exp
      FROM control_tiempo_aclaracion
      WHERE SUBSTRING(LTRIM(RTRIM(id_exp)), 0, CHARINDEX('//', LTRIM(RTRIM(id_exp)))) LIKE 'ARIT-LPZ-%/2021%'
        AND LEN(id_exp) > 20
      GROUP BY LTRIM(RTRIM(id_exp))) AS dd
ORDER BY dd.id_exp;

ARMAR
LTRIM(RTRIM(ct.id_exp))

ARIT-LPZ-0244/2016//ARIT-LPZ-0243/2016//ARIT-LPZ-0304/2016,10442


SELECT LTRIM(RTRIM(origen))
FROM control_tiempo_aclaracion
WHERE LTRIM(RTRIM(id_exp)) LIKE 'ARIT-LPZ-%/2021%'
GROUP BY LTRIM(RTRIM(origen))
ORDER BY LTRIM(RTRIM(origen));

SELECT LTRIM(RTRIM(destino))
FROM control_tiempo_aclaracion
WHERE LTRIM(RTRIM(id_exp)) LIKE 'ARIT-LPZ-%/2021%'
GROUP BY LTRIM(RTRIM(destino))
ORDER BY LTRIM(RTRIM(destino));


SELECT *
FROM (SELECT ISNULL((SELECT TOP 1 cargo FROM usuario AS u WHERE u.id_user = ct.origen), 'ACAMARA')  AS cargoorigen,
             ISNULL((SELECT TOP 1 cargo FROM usuario AS u WHERE u.id_user = ct.destino), 'ACAMARA') AS cargodestino
      FROM control_tiempo_aclaracion AS ct
      WHERE id_exp LIKE 'ARIT-LPZ-%/2021%') AS temp
GROUP BY temp.cargoorigen, temp.cargodestino
ORDER BY temp.cargoorigen, temp.cargodestino;



SELECT dd.id_exp, 1 AS id
FROM (SELECT LTRIM(RTRIM(id_exp)) as id_exp
      FROM control_tiempo_aclaracion
      WHERE (LTRIM(RTRIM(id_exp)) LIKE 'ARIT-LPZ-%/2021%' OR LTRIM(RTRIM(id_exp)) LIKE 'ARIT-LPZ-%/2022%')
        AND LEN(id_exp) <= 20
      GROUP BY LTRIM(RTRIM(id_exp))) AS dd
ORDER BY dd.id_exp;


select (select ra.numero_recurso_alzada
        from alzada.alz_recursos_alzada ra
        where ra.id = temp.id_recurso_alzada) as numero_recurso_alzada,
       temp.id                                as id_aclaracion
from (select id_recurso_alzada, id
      from alzada.alz_aclaraciones
      where id_recurso_alzada in (
          select id
          from alzada.alz_recursos_alzada
          where numero_recurso_alzada in (

              )
      )) AS temp
order by numero_recurso_alzada;

ARMAR
LTRIM(RTRIM(ct.id_exp))

